# hydroponic
This repository contains the software to control a hydroponic system. This system integrates Particle Photon and a pH sensor, using IoT to deliver important messages to the user over Slack if any sensor measurements are found to be suboptimal for growing. For the user, the goal of the system is to build a sustainable growing system that would provide enough lettuce to support the salad needs of a family of four. For the builder (me), the goal was to explore my interdisciplinary skills and begin to narrow down and focus my attention on a specific career path by developing and building a project that integrates my technological skills with my interest in sustainability. Below, you can find detailed documentation of my daily progress on the project.

### Documentation
I will be finishing my undergraduate education in less than a year, and will need to start looking at jobs soon. I’m studying computer science, with a minor in both environmental studies and sustainability. I want to pick a project that integrates my interests and requires many different skills so that I will be able to look back and reflect on which skills I enjoyed and learned from the most. For example, by going over the aspects of the projects that I felt the most driven to complete as well as the aspects that I was less motivated or interested in, I can compare these to the types of problem solving skills to the ones used in specific careers.  If I decide that I was more inspired and driven to complete the building and hardware components, then an engineering career might be a better choice than software development. If I prefer programming and debugging code over working with breadboards, then maybe electrical engineering is not the career for me. 
Throughout this log I will be documenting my daily progress on the hydroponic gardening system. It will include information about the project, its working requirements, background information about the system, and why these requirements are necessary. It is not meant to be an all-encompassing tutorial guide for how to build this project, but it will have the information needed to understand the components of the system and inspire similar ideas. This log will be useful to anyone who is interested in building a system with similar goals; the technology used could be applied to another project that solves a problem or optimizes a process. If the goal of a project is to combine IoT and sensors to inform a user, this log would be useful to them. Additionally, someone interested in building their own hydroponic system will find this log useful because it details some of the specific requirements of hydroponic systems. 

#### Day 1: Proposing the Ideas
I start the day with brainstorming ideas that involve sustainability and technology. Rather than take a particular technology and try to make it more sustainable, I prefer to take something sustainable and think of ways to incorporate technology to optimize it. Urban agriculture is a natural place for me to start because I enjoy working in my small garden where I’m currently growing strawberries, zucchini, eggplant, and bell peppers, and I think it is a very accessible way for anyone to reduce their carbon footprint. For me, having a relationship with agriculture is an important aspect of sustainability. When I picture a sustainable world, I imagine one where people that can rely on themselves to use the earth around them to meet their basic needs, such as putting healthy food on the table. Conventional agriculture is rapidly depleting the soil that is needed to grow food, resulting in heavy use of synthetic fertilizers and pesticides. Not only do these practices harm the earth on and beyond the farm, but as we are stripping soil of its nutrients, we are running out of viable land to grow crops. If more people rely on subsistence agriculture instead of conventional agricultural, every household will reduce their carbon footprint by becoming more of a closed loop system, reducing their plastic and transportation usage, and reducing the conventional use of pesticides and synthetic fertilizers. In the United States, conventional industrial agriculture contributes to nearly 20% of its total atmospheric carbon dioxide emissions. In Metro Manila, it was calculated that a hydroponic rooftop system used 134.54 tons less carbon per 100 tons of lettuce when compared to average 100 tons of lettuce in the city(1). Sustainability within our food system is important not only for our health but also because it is the only way to enable future generations of people to have access to the resources and food variety that we have today. The project I will design will offer a viable, convenient, and sustainable alternative to buying from conventional farmers at the grocery stores. By connecting the user to their food, the user will gain a deeper understanding of our food system and what goes into growing food, thus creating a more sustainable earth. Unfortunately, this shift to a more sustainable alternative to our current food system can be intimidating for people, especially for those who do not think they have a ‘green thumb’. Ideally, my project will help take away that fear by making it accessible and convenient, and allow people to embrace having a closer relationship to the earth.
While browsing online, I took inspiration from multiple projects and started thinking about ways I could combine multiple features from each, while ensuring that the end result is uniquely mine. The two projects that caught my eye were 1) greenhouse, and 2) hydroponic systems. Not only did they involve gardening and sustainability, but they had cool hacks to automate and incorporate technology to improve production of such systems. This is exactly what I was looking for. I concluded the day with two big ideas:
Greenhouse with an automated drip irrigation system that would be triggered by a sensor that measures soil moisture. It would have an automated temperature control system that opens a window to the greenhouse if it gets too hot. This greenhouse would allow its user to grow all types of plants year round in a controlled environment optimal for growing because it would be protected from frost in the cold months. Be it fruits and vegetables or exotic plants, this greenhouse would be able to grow it all. 

Automated hydroponics system that measures pH, nutrient content, and water level. Hydroponic systems have the advantage of saving an incredible amount of space and resources because it does not require soil or garden beds, uses up to 90% less water than traditional gardening, and has a vertical design that can be put in a small space like a porch or balcony. This hydroponic system would allow the user to grow an incredible amount of food in very little space, while requiring very little maintenance. This system would notify the user if any of these measurements were found to be suboptimal. This would take a lot of the guessing out of hydroponics and make it easier for people with little gardening experience to maintain their crops. 

Both of these systems would allow the user to grow a wide array of fruits and vegetables year round, offering fresh, available, pesticide free produce at their fingertips. Both of these projects incorporate sustainable practices into everyday life and take away the fear of growing your own food. Given the importance of sustainability in these projects, both of these systems would be solar powered to reduce the use of fossil fuels and create a fully isolated, self sustaining electrical system that would keep working if the household power happens to go out.  Additionally, it is fitting that a plant growing system gets its energy from the same source as the plants. 
On the technical side, both systems would use various sensors requiring some wiring and electrical engineering knowledge. I will use IoT for automating the system and delivering information from the sensors to the user. IoT stands for  “Internet of Things”, a term for integrating internet (cellular or wifi) connectivity to a device. This device could be an electronic sensor, an appliance, or even a car. The definition of IoT devices is quite broad. Both projects would require an adequate amount of construction. I have little to no prior experience with these three skills:  1) electrical engineering, 2) IoT, and 3) construction), so this project will undoubtedly be an exciting challenge. If I have learned anything since pursuing computer science, it’s not to let the unknown intimidate me, because I won’t know how hard it is until I try! 
All my research thus far has been equally exciting and nerve-racking. Although there are a lot of new skills to learn, and a lot of work to do, I can’t help but feel the excitement of bringing this project to life. This is more complex and large scale than any project I have done and I am going to have to learn a lot very quickly over the next three weeks. Despite my nerves, I am grateful to have an opportunity to build something like this. 

#### Day 2: Tradeoffs and Decisions
My biggest constraint is time, and since I don’t have much experience with construction, I realized that building a greenhouse from scratch was a little too ambitious. Plus, I didn’t want to risk the greenhouse being potentially unsafe if my construction skills turned out to be sub par. This led me to choose the hydroponic system as my project. I decided it would be best to purchase a hydroponic system kit, which, that day, happened to be on sale. This kit would save me a lot of time in terms of construction, so it worked out very well. As for features, I decided to make the system alert the user of any problems (low pH, low nutrient levels, low water) but not actually fix the problem itself. If I have extra time, I will consider adding this ability. After reading the reviews and making decisions based on what was available through Amazon Prime, I decided to get a two tiered, 54 plant hydroponic kit. 

Next, I looked for electronic components for the project. These included sensors (to check environmental conditions) and microcontrollers (brain of the project). Raspberry Pi and Arduino are very popular among hobbyists, but they would require creating my own database and app for sending and receiving data, and I was unsure if I could finish building those aspects within the given time. I started looking at a microprocessor called the Particle Photon. It intrigued me because it is fully integrated, meaning that it is wifi enabled, has its own cloud for data storage, has its own IDE, and can be easily integrated with web apps such as IOS, Android, Google spreadsheets, Slack, and more. These built in features would eliminate the need for me to create my own database and app. To make things even easier for hobbyists like me, Photon also comes with a sensor kit (additional purchase), free tutorials, and comprehensive documentation. These aspects combined allowed me to decide on the Photon as my microprocessor because it combined many of the aspects I needed for the project into one device. 

#### Day 3: Sensors!
Now it’s time to research sensors. My original goals were to get sensors to measure pH (water acidity), electrical conductivity (nutrient density), and water level. I found out that EC sensors interfere with pH sensors, so I am holding off on the EC sensor for now. I decided to give pH priority because it cannot be predicted or seen without testing the water with a kit or a sensor, whereas nutrient level drops can be monitored more easily by looking for wilting leaves. Also, in terms of research, it would be very interesting to observe which pH levels are optimal for plant growth. As for the EC sensor, it would not measure the density of specific compounds such as calcium or nitrogen, while would be less useful for research. Additionally, if the pH of the water is not at an optimal level, the plant becomes unable to absorb the nutrients necessary to grow and thrive. Therefore, the nutrient density is irrelevant if the pH is at a level where the plant cannot absorb any of those nutrients. After taking inventory of the sensors already available to me, I decided to order the pH sensor.
After ordering the pH sensor, I had finished ordering most of the parts that I would need for the project, so I kept myself productive and moving forward by playing around with the Particle Photon while I waited for all of the parts to arrive. There are many free tutorials online which I watched, and then I decided to try a project on my own that would be similar to what I will be doing once the pH sensor comes in the mail. Using the waterproof temperature sensor and the Photon, I was able to send a message that said "the temperature is ___ " over Slack. Slack is a software tool used by companies to send messages to each other. It was used in one of the tutorials as one of Particle’s integrated web applications, and I am a fan of how Slack uses different ‘channels’ (sort of like different group chats) for various topics of discussion. I decided to use Slack and create a specific channel dedicated to the water temperature. I did this by creating a webhook from Particle to Slack. Particle has a built in feature that allows you to post information and data to that webhook. Additionally, you can set the webhook to format the information to say “the temperature is {data_value}”. Once I wired the water temperature sensor to the Photon, I used Particle’s IDE to program the Photon to send the sensor’s readings to the webhook. Although I needed some refreshing on circuits and breadboards, I got it working and I started getting notifications on Slack. This was a really rewarding exercise that got me excited to use the Photon for my project. Before this, I did not know anything about webhooks and web application integrations so it was very interesting to see how these technologies can work together so seamlessly. 

After getting oriented with the Photon, I feel comfortable that I could replicate this work when the pH sensor was delivered, although it will take a little bit more testing than the water temperature sensor. This is due to the fact that my sensor will be giving me analog readings, which need to be converted to the pH scale. 
Next, I set up a mini hydroponic system and tested it to see how it works, so this way I can troubleshoot the large scale version of it once it comes in the mail. The ad listing for the hydroponics kit online is pretty vague so I won’t really know how the system works or what modifications I will need to make until I have it set up. Lastly, I went into the area where the system is going to be built, checked up on the sun exposure to make sure the system will be getting at least 4 hours of sunlight a day, and started imagining where I should place the solar panel. There is one corner of the area that is almost always in direct sunlight, so that would be a great spot for it, I just need to decide how to mount it. 

#### Day 4: The Solar Panel Mount
Today I built the solar panel mount. This took a bit of planning, and my overall design was to mimic an artist’s easel, but with a rectangular frame instead of a triangular frame. The day was spent buying, sawing, and drilling into wood. The mount has four legs. The back two legs are much taller at about 5 feet, and the front legs are shorter and just under 4 feet. There are horizontal support beams just below the top of the front legs, and diagonal beams for the solar panel to rest on at an approximate 30 degree angle from the sun. The panel is facing southeast, and will receive direct sunlight for the majority of daylight hours. The final product looks like this:
 
I really enjoyed doing hands on work today especially because it was a sunny afternoon, and it was the first tangible thing I had assembled/built for the project. Prior to this, I did not have much experience with building large structures so this was new to me, but I found it to be very rewarding. Luckily, the solar panel is not very heavy. I would not go out to build any heavy weight bearing structures without a little more practice, but I found building the structure to be easier than I expected and fun to do.

#### Day 5: Putting Together the Kit
The hydroponic kit arrived, so I spent the day putting it together and testing it. After a bit of troubleshooting, I was able to get water through each of the pipes. The system works by using a pump to send water through a tube to the top of the system, where the water can flow through any of the three top rows. Then, with the remaining force from the pump along with gravity, the water drops to the lower level of rows, where the water can flow down any of the three rows. For equal distribution between the rows, the system must be level. Lastly, the water exits out of the exit spout (pictured below on the far side of the lower level). 

The only downside to the kit is that the pump that it comes with is a little too strong, which will be hard on the roots of the plants. The holes are also closely spaced, which will crowd wide growing plants such as lettuce and will require a bit of intercropping. That being said, it was a huge time saver to buy a premade kit. If time had not been a constraint, I would prefer to build my own system so that I could have it customized to my preferences. For example, it would be hard to expand this system to include more rows for more plants. If I had built the system myself, it would be much less difficult to find parts of matching size and much easier to add on rows. Nevertheless, the system will still work great and serve its purpose. Today was fun because I felt like my project was really coming to life. Being able to look at the system structure and visualize plants growing in it was very exciting. 

#### Day 6: Preparing for the Sensor
Now that I have built the bulk of the system, it is time to get to the electrical side of things. In hydroponic systems, water quality is the most important factor to control. The pH sensor will add a lot of value to this system because plants can only grow in water within a certain pH. Beyond that, plants have an optimal pH range, so ensuring that the water stays within this range will allow plants to thrive. Plants prefer slight acidity, so the optimal pH range for the majority of vegetables is 6.0 to 6.5 pH. Some vegetables have wider ranges than this, and every plant is unique, but I deemed this to be the best ‘one size fits all’ range for most vegetables. It will be very interesting to see how pH affects plant growth in different varieties of plants. As I waited for my pH sensor to come in the mail, I started looking up code and projects that use the same sensor. I bought the pH sensor from a vendor called DF Robot. There was a good amount of documentation that I read through and I also refreshed myself on some of the electrical components that I would need to be using. I also found projects online that used the same sensor that I could use for reference. The only minor complication was that the examples were all used for Arduino instead of the Photon, so the code would need some tweaking. This was expected because the DF Robot sensor was built and advertised for Arduino. I also took this time to look over some of the documentation for the Photon in order to prepare myself for collecting and interpreting the data I would receive from the sensor. 


#### Day 7: Getting Stuck
Today I started working with the sensor. After trying some code that I found online and trying to write some code on my own, I was stumped because my sensor was reading the same numbers for water and vinegar, which have very different pH levels. Using the Arduino code I had found, I tried to use code from Photon’s website and my code from the water temperature sensor to convert it to Photon Code. For a while I was running different programs and getting different readings from the same water. Sometimes, I wouldn't get any readings, even after running a program that had, without changes, just provided me readings. I wasn’t entirely sure if my code was messed up or if something was wrong with the sensor. I was also confused by some of the conversions I found in the code online, which I later learned were Arduino specific conversions. I had been going back and forth removing the conversions or trying to alter them based off of the DF Robot documentation, but none of them gave me a number that was between 0 and 14. There was a little bit of a learning curve today because I haven't worked with a lot of this technology recently and don’t have much experience with Particle. Additionally, a lot of the Particle tutorials skip over the technological fundamentals and just tell you what to do, rather than why. So, when I ran into trouble, it was hard for me to source the error. I did a lot of troubleshooting along with reading and research online, but couldn't come to understand why I was getting the same readings for water and vinegar, so eventually I decided to call it a day.

#### Day 8: Acquiring and Plotting Data
This morning I realized there were a few fundamental electrical and Photon related skills that I was lacking, but after reading some more information, I figured out some of the things I was doing wrong. I ditched the code that I was previously working with and I found a very simple program in an introductory Photon book, which allowed me to get the readings from the sensor that actually made sense. This program was very simple, no bells and whistles, and output the raw readings from the sensor. This was a huge win after being stuck all day yesterday. I think one of the problems had to do with the fact that I have never coded with Particle before, so I was unfamiliar and inexperienced with some of their built in functions. Once I found a simple function that did nothing but display the sensor readings, I was able to take down data from various liquids:
Water: 2382
Coconut beverage: 2165
Tea: 1875
Sipping vinegar: 1280
Rice vinegar: 1153

After looking up expected pH values of these liquids (on a 0-14) scale, I plotted my data. I divided the values read by the sensor by the expected pH. After averaging these numbers, I determined that my divisor was approximately 350. So, if you divide the sensor reading by 350, that result is the approximate pH value on a 0-14 scale. Next, I started coding. I created the webhook from particle to slack, and began posting pH readings to the slack page that said “the pH is __ ". I didn’t want the system to be constantly overwhelming the user with notifications, so I programmed my system to alert the user only when the pH is outside of the optimal range. Then, for every .2 change in pH, the system will send an updated pH notification so that the user will know if they are fixing of worsening the problem. The user receives one last notification as soon as the pH is back within the normal range. Coding this look a little bit of patience because it required me simulating the changes in pH throughout various different liquids many different times. By this, I mean placing the sensor in water, then in vinegar, then in coconut beverage, then back in vinegar, and so on. After a bit of testing and debugging, I finished the code and had a working system. Today was very rewarding compared to yesterday, but I understand that getting stuck is all part of the process. Now I am looking forward to combining the hardware/software component with the physical system and bringing it all together. 

#### Day 9: Pump Day
Pumps are crucial to the success of plants in a hydroponic system. In a soilless system, such as a hydroponic system, water is the main source of life (other than the sun) for these plants. The water must contain the nutrients necessary for plants to grow and survive, and must be constantly flowing at an optimal rate. Too fast of a flow rate would damage roots, killing the plant. Too slow of a rate can create dead spots in which plant roots have absorbed all of the nutrients within their reach, and can no longer receive the nutrients that they need. Additionally, still water can be a breeding ground for bacteria, alage, fungi, and pests. As a result, the water must be flowing at a speed fast enough to deliver nutrients and slow enough to keep the roots healthy. 
Since my pump and timer came in the mail today, it was time to compare the three pumps that I had to determine the best one for the system.
- Pump 1: The pump that I ordered on amazon
This pump was very strong and would need to be kept on a timer with a speed controller in order to make sure that the roots were not damaged by the strong flow.  It also has very short wires, and would require a lot of wiring to connect the speed and timing components that would need to be made waterproof.
- Pump 2: The pump that came with the system
This pump was decent but it also had a very strong flow. I noticed that there is a way to adjust the intake and subsequent output of water, which reduced the strength of the water flow significantly, but the pump would need to be kept on its lowest possible setting. Additionally, a lot of the reviews for the kit mentioned that the pump was not very reliable and too forceful for the plants, so I would need to be extra cautious. 
- Pump 3: The aquarium pump that I already had
This pump was the best because it had the softest strength, which would keep the roots from being damaged. There was a gentle, yet steady flow of water. I am also able to look up instructions and information on this pump online since I bought it from a third party vendor, and could replace it easily.

The final decision was to go with the aquarium pump. It seems to be the most reliable pump and least likely to damage the plants, while also not needing additional parts in order to work optimally. 
I also finished an electrical diagram for the sensor, which can be found [here](https://github.com/malikmayank/hydroponic/blob/master/phsensor_photon.fzz).

#### Day 10: Tubing Troubles
Today I moved the system to its final spot near the solar panel with the hopes of setting everything up. Previously, I had been using a makeshift bin as the water tank, but now I had access to the full sized tank that would be used. This tank is very large so that it does not need to be refilled often. This eliminated the need for a water level sensor. That convenience, however, necessitated some unexpected changes in the set up. The tank is taller than the lowest row of plants, so the system needed to be raised. After adding a few layers of bricks under the legs, we decided it would be best to cut up some wood for a more supportive base. The tank is also wider than the base of the system, meaning that the tank cannot fit underneath. 

So, the tank must rest to the side of the system. Unfortunately, this means that the hose does not reach the tank. 
My first solution was to use one of the extra pumps and some extra tubing, and use a bucket along with the tank to transfer the output reservoir in the bucket into the input reservoir in the tank. But, I did not have the tubing required on hand, and if the pumps were not working at the same speed, one of the buckets could overflow or run dry, which could break the pump and/or the system.
Another solution was to cut holes into each of the containers and use gravity and tubing to move water from one to the other. But, this would require some cutting/duct tape/hot glue which could get messy. I kept trying to think of an easier way. 
My next thought was to get a longer tube. After going to Home Depot and picking up tubing, I got home to find that the diameter of the hole in the tubing was correct (the tubing fit onto the pump’s output valve), but the tube was thicker than the one that came with the kit, so it would not fit inside the tubing hole that would connect it to the system. I thought it would be unsightly and unprofessional to try and adhere the two tubes together, so I scratched that idea. 
After staring at the system for a while, I wondered if I could manipulate it so that both the input value and the output spout were on the same side. I had assembled the kit according to instructions, which had them on opposite sides. After struggling with the pipes for a little bit, I got them to face the same direction. I was not sure if this would affect the water flow within the system because if there are any blockages or mechanical impedances going on within the pipes, I cannot see them. Luckily, the system ran smoothly. 
Although I am happy with the fact that the system is up and running with the tank, I can’t help but notice that the solution that worked the best was the one that required the least amount of construction and additional parts. A part of me wishes I had thought of my last idea in the first place, but it was a good learning experience because I felt the iterative process of troubleshooting come to life today during my tubing troubles. I definitely felt very motivated to solve this problem, more so than the sensor problem. I believe it to be because I knew what I wanted as a result, which was to connect the input and output. With the sensor, I was unsure what type of result I should be looking for, and did not understand how the sensor was obtaining values. With the tank problem, I understood the processes of the system because I built it myself, and was able to iterate through potential solutions with ease. 

#### Day 11: Putting it all Together

After picking up housing to store the electronics such as the battery, the Photon, and the breadboard, everything was ready to put together. The tank fit compactly under the solar panel stand, and the housing fit nicely under the panel. I am really proud of the finished product and the amount that I have learned throughout this process. I will definitely be building more hydroponic systems in the future, and look forward to having and endless supply of fresh salad greens. This system is also great because it acts as a great starting point for many additional gardening projects that can be powered by the same tank and battery. 

* In a few months, I will update this documenation with some information about the growing success, as well as cost effectiveness data.

References
Taylor, Robert, et al. “Making Global Cities Sustainable: Urban Rooftop Hydroponics for Diversified Agriculture in Emerging Economies.” SSRN, OIDA International Journal of Sustainable Development, 20 Dec. 2012, papers.ssrn.com/sol3/papers.cfm?abstract_id=2192203.
